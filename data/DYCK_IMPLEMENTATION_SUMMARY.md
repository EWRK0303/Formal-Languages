# Dyckè¯­è¨€ç”Ÿæˆå™¨å®ç°æ€»ç»“

## æ¦‚è¿°

åŸºäºæŒ‡å—ä¸­çš„è¦æ±‚ï¼Œæˆ‘ä¸ºæ‚¨çš„é¡¹ç›®åˆ›å»ºäº†å®Œæ•´çš„Dyckè¯­è¨€ç”Ÿæˆå™¨å®ç°ã€‚è¿™ä¸ªå®ç°å®Œå…¨é€‚é…æ‚¨ç°æœ‰çš„é¡¹ç›®ç»“æ„ï¼Œå¹¶ä¸æ‚¨ç°æœ‰çš„ä»£ç é£æ ¼ä¿æŒä¸€è‡´ã€‚

## å®ç°çš„æ–‡ä»¶

### 1. æ ¸å¿ƒç”Ÿæˆå™¨ (`gen_dyck.py`)
- **DyckLanguageç±»**: æ ‡å‡†Dyckè¯­è¨€ç”Ÿæˆå™¨
- **RDyck1Languageç±»**: é‡ç½®Dyck-1è¯­è¨€ç”Ÿæˆå™¨
- **ä¾¿æ·å‡½æ•°**: `generate_dyck_dataset()`, `generate_rdyck_dataset()`

### 2. PyTorchæ•°æ®é›† (`dyck_dataset.py`)
- **DyckDatasetç±»**: åŸºç¡€æ•°æ®é›†ç±»
- **DyckLanguageDatasetç±»**: æ ‡å‡†Dyckæ•°æ®é›†
- **RDyckDatasetç±»**: é‡ç½®Dyckæ•°æ®é›†
- **è¯æ±‡è¡¨å‡½æ•°**: `create_dyck_vocab()`, `create_rdyck_vocab()`

### 3. æ•°æ®ç”Ÿæˆè„šæœ¬ (`generate_dyck_data.py`)
- å‘½ä»¤è¡Œå·¥å…·ï¼Œç”¨äºç”Ÿæˆå’Œä¿å­˜æ•°æ®é›†
- æ”¯æŒè®­ç»ƒé›†ã€éªŒè¯é›†åˆ†ç®±
- ç”Ÿæˆå¤šç§æ ¼å¼çš„è¾“å‡ºæ–‡ä»¶

### 4. ä½¿ç”¨ç¤ºä¾‹ (`example_dyck_usage.py`)
- å®Œæ•´çš„ä½¿ç”¨ç¤ºä¾‹
- æ•°æ®åŠ è½½å™¨åˆ›å»º
- æ‰¹å¤„ç†å‡½æ•°

### 5. è®­ç»ƒç¤ºä¾‹ (`train_dyck_example.py`)
- å®Œæ•´çš„è®­ç»ƒæµç¨‹
- æ¨¡å‹åˆ›å»ºå’Œè®­ç»ƒ
- è¯„ä¼°å’Œæ¨ç†

### 6. ç»¼åˆæµ‹è¯• (`test_dyck_all.py`)
- å…¨é¢çš„åŠŸèƒ½æµ‹è¯•
- è¾¹ç•Œæƒ…å†µæµ‹è¯•
- æ•°æ®ä¸€è‡´æ€§éªŒè¯

## ä¸»è¦ç‰¹æ€§

### 1. æ ‡å‡†Dyckè¯­è¨€æ”¯æŒ
- æ”¯æŒ1-7ç§æ‹¬å·å¯¹ï¼š`()`, `[]`, `{}`, `<>`, `+-`, `ab`, `xo`
- å¯é…ç½®çš„ç”Ÿæˆå‚æ•°ï¼š`p`ï¼ˆåµŒå¥—æ¦‚ç‡ï¼‰, `q`ï¼ˆè¿æ¥æ¦‚ç‡ï¼‰
- æ ˆçŠ¶æ€è¾“å‡ºç”Ÿæˆ

### 2. é‡ç½®Dyck-1è¯­è¨€æ”¯æŒ
- åœ¨Dyckå­—ç¬¦ä¸²ä¸­æ’å…¥é‡ç½®ç¬¦å·'1'
- æ ˆé‡ç½®åŠŸèƒ½
- ç‰¹æ®Šçš„æ ˆçŠ¶æ€å¤„ç†

### 3. ä¸ç°æœ‰ä»£ç çš„å®Œç¾é›†æˆ
- ä¸`FormalLanguageDataset`ä¿æŒä¸€è‡´çš„æ¥å£
- ä¸ç°æœ‰æ¨¡å‹æ¶æ„å…¼å®¹
- ç›¸åŒçš„ä»£ç é£æ ¼å’Œå‘½åè§„èŒƒ

### 4. å®Œæ•´çš„æ•°æ®å¤„ç†æµç¨‹
- æ•°æ®ç”Ÿæˆ â†’ æ•°æ®é›†åˆ›å»º â†’ æ•°æ®åŠ è½½å™¨ â†’ æ¨¡å‹è®­ç»ƒ
- æ”¯æŒæ‰¹å¤„ç†å’Œå˜é•¿åºåˆ—
- å¤šç§è¾“å‡ºæ ¼å¼

## å¿«é€Ÿä½¿ç”¨æŒ‡å—

### 1. åŸºæœ¬ä½¿ç”¨
```python
from data.dyck_dataset import get_dyck_dataset
from torch.utils.data import DataLoader

# è·å–æ•°æ®é›†
dataset = get_dyck_dataset(n_samples=1000, seq_len=16, num_pairs=2)

# åˆ›å»ºæ•°æ®åŠ è½½å™¨
loader = DataLoader(dataset, batch_size=32, shuffle=True)
```

### 2. ç”Ÿæˆå’Œä¿å­˜æ•°æ®é›†
```bash
python -m data.generate_dyck_data \
    -lang Dyck \
    -num_par 2 \
    -dataset Dyck-2 \
    -training_size 10000 \
    -test_size 2000
```

### 3. è¿è¡Œç¤ºä¾‹
```bash
python -m data.example_dyck_usage
python -m data.train_dyck_example
```

## ä¸æŒ‡å—çš„å¯¹åº”å…³ç³»

### æŒ‡å—è¦æ±‚ vs å®ç°

| æŒ‡å—è¦æ±‚ | å®ç°æ–‡ä»¶ | åŠŸèƒ½ |
|---------|---------|------|
| DyckLanguageç±» | `gen_dyck.py` | æ ‡å‡†Dyckè¯­è¨€ç”Ÿæˆ |
| RDyck1Languageç±» | `gen_dyck.py` | é‡ç½®Dyckè¯­è¨€ç”Ÿæˆ |
| è¯æ±‡è¡¨ç®¡ç† | `dyck_dataset.py` | è‡ªåŠ¨è¯æ±‡è¡¨åˆ›å»º |
| æ•°æ®é›†ç±» | `dyck_dataset.py` | PyTorchæ•°æ®é›†æ¥å£ |
| æ•°æ®ç”Ÿæˆè„šæœ¬ | `generate_dyck_data.py` | å‘½ä»¤è¡Œå·¥å…· |
| è®­ç»ƒç¤ºä¾‹ | `train_dyck_example.py` | å®Œæ•´è®­ç»ƒæµç¨‹ |

### å‚æ•°å¯¹åº”
- `num_pairs`: æ‹¬å·å¯¹æ•°é‡ (1-7)
- `p`: åµŒå¥—æ¦‚ç‡
- `q`: è¿æ¥æ¦‚ç‡
- `min_size/max_size`: å­—ç¬¦ä¸²é•¿åº¦èŒƒå›´
- `min_depth/max_depth`: åµŒå¥—æ·±åº¦èŒƒå›´

## è¾“å‡ºæ ¼å¼

### è¾“å…¥æ ¼å¼
Dyckå­—ç¬¦ä¸²ï¼Œä¾‹å¦‚ï¼š`"(()())"`, `"[[]()]"`

### è¾“å‡ºæ ¼å¼
æ¯ä¸ªä½ç½®çš„æ ˆçŠ¶æ€ï¼ˆone-hotç¼–ç ï¼‰ï¼š
- `[1, 0]`: ç©ºæ ˆ
- `[0, 1]`: éç©ºæ ˆ

## æµ‹è¯•ç»“æœ

æ‰€æœ‰åŠŸèƒ½éƒ½ç»è¿‡äº†å…¨é¢æµ‹è¯•ï¼š
- âœ… Dyckè¯­è¨€ç”Ÿæˆå™¨æµ‹è¯•
- âœ… é‡ç½®Dyckè¯­è¨€ç”Ÿæˆå™¨æµ‹è¯•
- âœ… æ•°æ®é›†ç”Ÿæˆæµ‹è¯•
- âœ… PyTorchæ•°æ®é›†æµ‹è¯•
- âœ… è¯æ±‡è¡¨åˆ›å»ºæµ‹è¯•
- âœ… æ•°æ®ä¸€è‡´æ€§æµ‹è¯•
- âœ… è¾¹ç•Œæƒ…å†µæµ‹è¯•

**æµ‹è¯•ç»“æœ: 7/7 é€šè¿‡** ğŸ‰

## æ–‡ä»¶ç»“æ„

```
data/
â”œâ”€â”€ gen_dyck.py              # æ ¸å¿ƒç”Ÿæˆå™¨
â”œâ”€â”€ dyck_dataset.py          # PyTorchæ•°æ®é›†
â”œâ”€â”€ generate_dyck_data.py    # æ•°æ®ç”Ÿæˆè„šæœ¬
â”œâ”€â”€ example_dyck_usage.py    # ä½¿ç”¨ç¤ºä¾‹
â”œâ”€â”€ train_dyck_example.py    # è®­ç»ƒç¤ºä¾‹
â”œâ”€â”€ test_dyck_all.py         # ç»¼åˆæµ‹è¯•
â”œâ”€â”€ README_dyck.md          # è¯¦ç»†æ–‡æ¡£
â””â”€â”€ DYCK_IMPLEMENTATION_SUMMARY.md  # æœ¬æ€»ç»“æ–‡æ¡£
```

## ä¸ç°æœ‰é¡¹ç›®çš„é›†æˆ

### 1. ä¸FormalLanguageDatasetå…¼å®¹
```python
from data.dataset import FormalLanguageDataset
from data.gen_dyck import generate_dyck_dataset

data = generate_dyck_dataset(n_samples=1000, seq_len=16)
dataset = FormalLanguageDataset(data)
```

### 2. ä¸ç°æœ‰æ¨¡å‹å…¼å®¹
```python
from data.dyck_dataset import get_dyck_dataset
from models.softmax_attention_transformer import SoftmaxAttentionTransformer

dataset = get_dyck_dataset(n_samples=10000, seq_len=16)
vocab_size = len(dataset.vocab)
model = SoftmaxAttentionTransformer(vocab_size=vocab_size, ...)
```

## æ‰©å±•æ€§

### 1. æ·»åŠ æ–°çš„æ‹¬å·å¯¹
```python
# åœ¨DyckLanguageç±»ä¸­ä¿®æ”¹
self.all_pairs = ['()', '[]', '{}', '<>', '+-', 'ab', 'xo', 'yz']
```

### 2. è‡ªå®šä¹‰è¾“å‡ºæ ¼å¼
```python
def custom_output_generator(self, string):
    # è‡ªå®šä¹‰è¾“å‡ºç”Ÿæˆé€»è¾‘
    pass
```

## æ€§èƒ½ç‰¹ç‚¹

- **é«˜æ•ˆç”Ÿæˆ**: ä½¿ç”¨é€’å½’ç”Ÿæˆç®—æ³•
- **å†…å­˜å‹å¥½**: æ”¯æŒç”Ÿæˆå™¨æ¨¡å¼
- **å¯æ‰©å±•**: æ”¯æŒå¤šç§æ‹¬å·å¯¹å’Œå‚æ•°é…ç½®
- **å…¼å®¹æ€§å¥½**: ä¸PyTorchç”Ÿæ€ç³»ç»Ÿå®Œç¾é›†æˆ

## æ€»ç»“

è¿™ä¸ªDyckè¯­è¨€ç”Ÿæˆå™¨å®ç°å®Œå…¨æ»¡è¶³äº†æŒ‡å—ä¸­çš„æ‰€æœ‰è¦æ±‚ï¼Œå¹¶ä¸”ï¼š

1. **å®Œå…¨é€‚é…**æ‚¨ç°æœ‰çš„é¡¹ç›®ç»“æ„
2. **ä¿æŒä¸€è‡´æ€§**ä¸æ‚¨ç°æœ‰çš„ä»£ç é£æ ¼
3. **åŠŸèƒ½å®Œæ•´**åŒ…å«æ‰€æœ‰å¿…è¦çš„ç»„ä»¶
4. **ç»è¿‡æµ‹è¯•**æ‰€æœ‰åŠŸèƒ½éƒ½ç»è¿‡éªŒè¯
5. **æ˜“äºä½¿ç”¨**æä¾›äº†è¯¦ç»†çš„ä½¿ç”¨ç¤ºä¾‹
6. **å¯æ‰©å±•**æ”¯æŒæœªæ¥çš„åŠŸèƒ½æ‰©å±•

æ‚¨ç°åœ¨å¯ä»¥ç›´æ¥ä½¿ç”¨è¿™äº›ä»£ç æ¥ç”ŸæˆDyckè¯­è¨€æ•°æ®é›†ï¼Œå¹¶ä¸æ‚¨ç°æœ‰çš„Transformeræ¨¡å‹è¿›è¡Œè®­ç»ƒå’Œå®éªŒã€‚ 